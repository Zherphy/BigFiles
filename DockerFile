FROM golang:1.21 as BUILDER

WORKDIR /home
RUN git clone https://github.com/opensourceways/BigFiles.git
RUN cd ./BigFiles && \
    go get github.com/akrylysov/algnhsa && \
    go build ./BigFiles/main.go

FROM openeuler/openeuler:22.03
LABEL maintainer="Zhou Yi 1123678689@qq.com"
RUN useradd -s /bin/bash BigFiles
USER BigFiles
WORKDIR /home/BigFiles
COPY --chown=BigFiles:group --from=BUILDER /home/BigFiles /home/BigFiles/

EXPOSE 5000
ENTRYPOINT ["/home/BigFiles/main"]